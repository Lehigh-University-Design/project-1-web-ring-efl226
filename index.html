<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Record Collection</title>
</head>


 
<body>
    
        <h1>Album Explorer</h1>
        <p>Explore my favorite vinyl records!</p>
        <button id="toggleViewBtn">Switch to Carousel View</button>
        <div>
        <button id="resetViewBtn">Reset Grid View</button>
        </div>
    
    
    <canvas id="canvas"></canvas>
    <script> 
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let viewMode = "grid"; // "grid" or "carousel"
        let currentIndex = 0;  // for carousel mode

        // Now I am going to add albums to the page statically
        //Albums with cover + title + position
    const albums = [
        { title: "Young M.A. - Herstory EP", cover: "images/albums/Young_M.A_Herstory_-_EP.jpg", x: 100, y: 100 },
        { title: "98", cover: "images/albums/98°_2.0.jpg", x: 400, y: 100 },
        { title: "B.o.B - Underground Luxury", cover: "images/albums/B.o.B_Underground_Luxury.jpg", x: 700, y: 100 },
        { title: "Bobby Caldwell - Perfect Island Nights", cover: "images/albums/bobbycaldwell_perfectislandnights_d4m2.jpg", x: 1000, y: 100 },
        { title: "Brett Eldredge - Bring You Back", cover: "images/albums/Brett_Eldredge_Bring_You_Back.jpg", x: 100, y: 400 },
        { title: "Bruce Faulconer - DragonBall Z Lost Tracks Vol. 6", cover: "images/albums/Bruce_Faulconer_The_Best_of_DragonBall_Z,_Vol._6_-_The_Lost_Tracks_of_DBZ.jpg", x: 400, y: 400 },
        { title: "Bruno Mars - 24K Magic", cover: "images/albums/Bruno_Mars_24K_Magic.jpg", x: 700, y: 400 },
        { title: "C.W. McCall - Greatest Hits", cover: "images/albums/C.W._McCall_C._W._McCall's_Greatest_Hits.jpg", x: 1000, y: 400 },
        { title: "Charlie Puth - Nine Track Mind", cover: "images/albums/Charlie_Puth_Nine_Track_Mind.jpg", x: 100, y: 700 },
        { title: "Cody Simpson - 4 U EP", cover: "images/albums/Cody_Simpson_4_U_-_Ep.jpg", x: 400, y: 700 },
        { title: "Cordae - The Lost Boy", cover: "images/albums/cordae_thelostboy_fq2k.jpg", x: 700, y: 700 },
        { title: "D.H.T. ft. Edmée - Listen to Your Heart", cover: "images/albums/D.H.T._Featuring_Edmée_Listen_to_Your_Heart.jpg", x: 1000, y: 700 },
        { title: "David Guetta - 7", cover: "images/albums/David_Guetta_7.jpg", x: 1300, y: 100 },
        { title: "David Guetta & Showtek - Your Love Single", cover: "images/albums/davidguettashowtek_yourlovesingle_b2co.jpg", x: 1300, y: 400 },
        { title: "Dean Martin - The Dean Martin TV Show", cover: "images/albums/deanmartin_thedeanmartintvshow_fauu.jpg", x: 1600, y: 100 },
        { title: "D.R.U.G.S. - Destroy Rebuild Until God Shows", cover: "images/albums/Destroy_Rebuild_Until_God_Shows_(D.R.U.G.S.)_D.R.U.G.S..jpg", x: 1600, y: 400 },
        { title: "DJ Snake & Lil Jon - Turn Down for What (Remix)", cover: "images/albums/DJ_Snake_&_Lil_Jon_Turn_Down_for_What_(Remix)_[feat._Juicy_J,_2_Chainz_&_French_Montana]_-_Single.jpg", x: 1600, y: 700 },
        { title: "Dream Theater - Six Degrees of Inner Turbulence", cover: "images/albums/Dream_Theater_Six_Degrees_of_Inner_Turbulence.jpg", x: 1900, y: 100 },
        { title: "Eagles - Greatest Hits 1971-1975", cover: "images/albums/Eagles_Their_Greatest_Hits_1971-1975.jpg", x: 1900, y: 400 },
        { title: "Yo-Yo Ma & Silkroad Ensemble - Sing Me Home", cover: "images/albums/Yo-Yo_Ma_&_Silkroad_Ensemble_Sing_Me_Home.jpg", x: 1900, y: 700 },
        { title: "A.B. Quintanilla III Presents Kumbia Kings - Greatest Hits", cover: "images/albums/A.B._Quintanilla_III_Presents_Kumbia_Kings_A.B._Quintanilla_III___Kumbia_Kings_Presents_Greatest_Hits_(Album_Versions).jpg", x: 2200, y: 100 },
        { title: "A.R. Rahman - Lagaan (OST)", cover: "images/albums/A.R._Rahman_Lagaan_(Original_Motion_Picture_Soundtrack).jpg", x: 2200, y: 400 },
        { title: "ATLUS Sound Team - Persona 5 (OST)", cover: "images/albums/ATLUS_Sound_Team_Persona_5_(Original_Soundtrack).jpg", x: 2200, y: 700 },
        { title: "Aventura - K.O.B. Live", cover: "images/albums/Aventura_K.O.B._Live.jpg", x: 2500, y: 100 },
        { title: "Everclear - Ten Years Gone", cover: "images/albums/Everclear_Ten_Years_Gone_-_The_Best_of_Everclear_1994-2004.jpg", x: 2500, y: 400 },
        { title: "EXTREME - SIX", cover: "images/albums/EXTREME_SIX.jpg", x: 2500, y: 700 },
        { title: "Fifth Harmony - 7/27 (Deluxe)", cover: "images/albums/Fifth_Harmony_7_27_(Deluxe).jpg", x: 2800, y: 100 },
        { title: "Flo Rida - R.O.O.T.S. (Deluxe Version)", cover: "images/albums/Flo_Rida_R.O.O.T.S._(Deluxe_Version).jpg", x: 2800, y: 400 },
        { title: "Florida Georgia Line - Can't Say I Ain't Country", cover: "images/albums/Florida_Georgia_Line_Can't_Say_I_Ain't_Country.jpg", x: 2800, y: 700 },
        { title: "G-Eazy - These Things Happen", cover: "images/albums/G-Eazy_These_Things_Happen.jpg", x: 3100, y: 100 },
        { title: "Grimes - Visions", cover: "images/albums/Grimes_Visions.jpg", x: 3100, y: 400 },
        { title: "HerbalpertTheTijuana - The Beat of the Brass", cover: "images/albums/herbalpertthetijuana_thebeatofthebrass12b_h4ni.jpg", x: 3100, y: 700 }
    ];




    //track pan/zoom features
    let offsetX = 0, offsetY = 0, scale = 1;
    let isDragging = false, startX, startY;

    canvas.addEventListener("mousedown", e => {
        if (viewMode !== "grid") return;
      isDragging = true;
      startX = e.clientX - offsetX;
      startY = e.clientY - offsetY;
    });
    canvas.addEventListener("mouseup", () => {
      isDragging = false;
    });
    canvas.addEventListener("mouseleave", () => {
      isDragging = false;
    });
    canvas.addEventListener("mousemove", e => {
        if (viewMode !== "grid") return;
      if (isDragging) {
        offsetX = e.clientX - startX;
        offsetY = e.clientY - startY;
        draw();
      }
    });
    canvas.addEventListener("wheel", e => {
        if (viewMode !== "grid") return;
      e.preventDefault();
      const zoom = e.deltaY < 0 ? 1.1 : 0.9;
      scale *= zoom;
      draw();
    });

    //Create a function to draw the albums
    function draw() {
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (viewMode == "grid"){
            ctx.setTransform(scale, 0, 0, scale, offsetX, offsetY);
            albums.forEach(album => {
                if(album.img && album.img.complete){
                ctx.drawImage(album.img,album.x, album.y, 150, 150);
                } else{
                ctx.fillStyle = "gray";
                ctx.fillRect(album.x, album.y, 150, 150);
                }
            ctx.fillStyle = "#b76935";
            ctx.font = "16px Montserrat, sans-serif";
            ctx.fillText(album.title, album.x, album.y + 170);
        });
        } else if (viewMode == 'carousel'){
            const album = albums[currentIndex];
            const imgSize = Math.min(canvas.width, canvas.height) * 0.5;
            const imgX = (canvas.width - imgSize) / 2;
            const imgY = (canvas.height - imgSize) / 2 - 150;

            //Error handling for image loading
            if (album.img && album.img.complete) {
                ctx.drawImage(album.img, imgX, imgY, imgSize, imgSize);
            } else {
                ctx.fillStyle = "gray";
                ctx.fillRect(imgX, imgY, imgSize, imgSize);
            }

            ctx.fillStyle = "#b76935";
            ctx.font = "16px Montserrat, sans-serif";
            ctx.textAlign = "center";
            ctx.fillText(album.title, canvas.width / 2, imgY + imgSize + 40);

        }
        
    }

    let loadedCount = 0;
    albums.forEach(album => {
        const img = new Image();
        img.src = album.cover;
        img.onload = () => {
            loadedCount++;
            album.img = img;
            if (loadedCount === albums.length) {
                autoFit();
                draw();
            }
        };
        img.onerror = () => {
            console.error("Failed to load image:", album.cover);
            loadedCount++;
            if (loadedCount === albums.length) {
                autoFit();
                draw();
            }
        };
    });

    //Autt-fit function 
    function autoFit() {
        //Find border of albums
        const minX = Math.min(...albums.map(a => a.x));
        const minY = Math.min(...albums.map(a => a.y));
        const maxX = Math.max(...albums.map(a => a.x + 150));
        const maxY = Math.max(...albums.map(a => a.y + 600));

        const contentWidth = maxX - minX;
        const contentHeight = maxY - minY;

        //Scale so everything fits inside canvas
        const scaleX = canvas.width / contentWidth;
        const scaleY = canvas.height / contentHeight;
        scale = Math.min(scaleX, scaleY) * 0.9;

        //Center all the content
        offsetX = (canvas.width - contentWidth * scale) / 2 - minX * scale;
        offsetY = (canvas.height - contentHeight * scale) / 2 - minY * scale;
    }

    //Toggle view Button
    document.getElementById("toggleViewBtn").addEventListener("click", () => {
        if (viewMode === "grid") {
            viewMode = "carousel";
           document.getElementById("toggleViewBtn").innerText = "Switch to Grid View";
        } else {
            viewMode = "grid";
            document.getElementById("toggleViewBtn").innerText = "Switch to Carousel View";
        }
        draw();
    });
    //Reset View Button
    document.getElementById("resetViewBtn").addEventListener("click", () => {
        if (viewMode === "grid") {
            autoFit();
            draw();
        }
    });

    //Carousel navigation
    document.addEventListener("keydown", e => {
        if (viewMode !== "carousel") return;
        if (e.key === "ArrowRight") {
            currentIndex = (currentIndex + 1) % albums.length;
            draw();
        } else if (e.key === "ArrowLeft") {
            currentIndex = (currentIndex - 1 + albums.length) % albums.length;
            draw();
        }
    });
    // Get more ablum detials on click 
    canvas.addEventListener("click", e => {
        if (viewMode !== "grid") return;
        
        // Transform click coordinates to account for pan/zoom
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX - rect.left - offsetX) / scale;
        const y = (e.clientY - rect.top - offsetY) / scale;

        // Check if click is on any album
        for (let i = 0; i < albums.length; i++) {
            const album = albums[i];
            if(
                x >= album.x && x <= album.x + 150 &&
                y >= album.y && y <= album.y + 150
            ) {
                //Switch to carousel view of clicked album
                viewMode = "carousel";
                currentIndex = i;
                document.getElementById("toggleViewBtn").innerText = "Switch to Grid View";
                draw();
                break;
            }
        }
    });

    </script>
</body>
</html>